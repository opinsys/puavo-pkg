#!/bin/sh

set -eu

installdir=$1

symlink_targets='
/etc/dbus-1/system.d/skype.conf
/usr/bin/skype
/usr/share/applications/skype.desktop
/usr/share/icons/hicolor/128x128/apps/skype.png
/usr/share/icons/hicolor/16x16/apps/skype.png
/usr/share/icons/hicolor/24x24/apps/skype.png
/usr/share/icons/hicolor/256x256/apps/skype.png
/usr/share/icons/hicolor/32x32/apps/skype.png
/usr/share/icons/hicolor/48x48/apps/skype.png
/usr/share/icons/hicolor/64x64/apps/skype.png
/usr/share/pixmaps/skype.png
/usr/share/skype
'

for symlink_target in ${symlink_targets}; do
    mkdir -p $(dirname "${symlink_target}")
    ln -sf -T "${installdir}${symlink_target}" "${symlink_target}"
done

# for icon in /opt/spotify/spotify-client/Icons/spotify-linux-*.png; do
#   icon_size="${icon##*/spotify-linux-}"
#   xdg-icon-resource install --size "${icon_size%.png}" "${icon}" spotify-client
# done

# # It seems the desktop file has to match the mpris name.
# # I don't want to change that, so we use --novendor here
# xdg-desktop-menu install --novendor /opt/spotify/spotify-client/spotify.desktop
